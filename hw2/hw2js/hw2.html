<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Frequency Analizer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  </head>
<body>
    <div>
        <p class="h1">Question 1</p>
        <p class="h4">1.
            Choose 3 variables from our surveys
            <ul>
                <li class="list-item">
                    one Qualitative
                </li>
                <li class="list-item">
                    one Quantitative discrete
                </li>
                <li class="list-item">
                    one Quantitative continuous
                </li>
            </ul>
            create the most efficient algorithms to compute the frequency (absolute/relative/percentage) distribution of:
            <ul>
                <li class="list-item">
                    the 3 variables
                </li>
                <li class="list-item">
                    the joint distribution of 2 variables (use a general logic, where variables could be any number).
                </li>
            </ul>
            Double check/compare the results using some DBMS functionalities you prefer (eg., access, oracle online, postgres, ...)
            </p>

            <p class="h1">Solution 1</p>
            <p>I chose the survey about <a href="https://github.com/ZioNick1/nickstatistics.github.io/blob/main/datasets/Professional%20Life%20-%20Sheet1.tsv" target="_blank">professional life</a></p>
            <p>The 3 variables I chose are:
                <ul>
                    <li class="list-item">Background(degree) as the qualitative one</li>
                    <li class="list-item">Age as the quantitative discrete variable</li>
                    <li class="list-item">Height as the quantitative continuous variable</li>
                </ul>
            </p>
    </div>
    <div>
        <p>Upload the file you want to analize</p>
        <input type="file" id="results" onchange="tsvParser(this)" accept=".tsv">
    </div>
    <div>
        <p>The joint distribution will be:</p>
        <div id="results" onload="tsvParser(this)">

        </div>
    </div>
    <script>
        var matrix = [];
        var numCols;
        var numRows;
        function tsvParser(input){ //we get the file to analyze and put the results in a matrix
            let file = input.files[0];//here we store the content of the file
            let reader = new FileReader();
            reader.readAsText(file);//actually read the the content of the file as plain text
            reader.onload = ()=>{
                const content = reader.result;
                const rows = content.split('\n');
                rows.forEach((row) => {
                    const columns = row.split('\t')
                    matrix.push(columns);//we push the results in a matrix which is an array made of arrays
                });
                evalFrequency();
                calculateFrequencies();
            };
            reader.onerror = ()=>{
                console.log(reader.error)
            };
        }
        function evalFrequency(){
            //initializing objects to calculate absolute frequency
            var ageFrequency = {};
            var backgroundFrequency = {};
            var heightFrequency = {};
            //actual frequency calculation
            matrix.forEach((column)=>{
                for (let row = 0; row < matrix.length; row++) {//first for is for age frequency
                    if(matrix[0][column] === "Age"){
                        let age = matrix[row][column];
                        ageFrequency += (age || 0) + 1;
                    }
                }
                for (let row = 0; row < matrix.length; row++) {//second for is for height frequency
                    if(matrix[0][column] === "Height"){
                        let height = parseFloat(matrix[row][column]);
                        heightFrequency += (height || 0) + 1;
                    }
                }
                for (let row = 0; row < matrix.length; row++) {//third for is for background frequency
                    if(matrix[0][column] === "Background (degree)"){
                        let background = parseFloat(matrix[row][column]);
                        backgroundFrequency += (background || 0) + 1;
                    }
                }
            });
            displayTable(ageFrequency, 'Age');
            displayTable(backgroundFrequency, 'Background');
            displayTable(heightFrequency, 'Height');
        }
        function displayTable(frequencies, variable) {
            var table = '<h3>' + variable + '</h3>';
            table += '<table>';
            table += '<tr><th>Value</th><th>Absolute Frequency</th><th>Relative Frequency</th><th>Percentage</th></tr>';

            var total = Object.values(frequencies).reduce((acc, val) => acc + val, 0);

            Object.entries(frequencies).forEach(function ([key, value]) {
                var relativeFrequency = value / total;
                var percentage = (relativeFrequency * 100).toFixed(2) + '%';

                table += '<tr><td>' + key + '</td><td>' + value + '</td><td>' + relativeFrequency.toFixed(2) + '</td><td>' + percentage + '</td></tr>';
            });

            table += '</table>';
            document.body.innerHTML += table;
        }
        function calculateFrequencies(input = matrix) {
            // Initialize objects for frequencies
            var combinedFrequency = {};

            // Calculate frequencies for combined
            input.forEach(function (row) {
                var combined = row.join(' - ');
                combinedFrequency[combined] = (combinedFrequency[combined] || 0) + 1;
            });

            // Display the results in a table
            displayTableJ(combinedFrequency, 'Combined (Background - Age)');
        }
        function displayTableJ(frequencies, variable) {
            var table = '<h3>' + variable + '</h3>';
            table += '<table>';
            table += '<tr><th>Value</th><th>Frequency</th></tr>';

            Object.entries(frequencies).forEach(function ([key, value]) {
                table += '<tr><td>' + key + '</td><td>' + value + '</td></tr>';
            });

            table += '</table>';
            document.getElementById('resultTables').innerHTML = table;
        }
    </script>
</body>
</html>